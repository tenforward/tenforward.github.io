<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[TenForward]]></title>
  <link href="http://tenforward.github.io/atom.xml" rel="self"/>
  <link href="http://tenforward.github.io/"/>
  <updated>2016-12-18T14:01:02+09:00</updated>
  <id>http://tenforward.github.io/</id>
  <author>
    <name><![CDATA[tenforward]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[コンテナ勉強会回顧録]]></title>
    <link href="http://tenforward.github.io/blog/2016/12/17/the-history-of-container-workshop/"/>
    <updated>2016-12-17T15:22:17+09:00</updated>
    <id>http://tenforward.github.io/blog/2016/12/17/the-history-of-container-workshop</id>
    <content type="html"><![CDATA[<p>この記事は<a href="http://www.adventar.org/calendars/1803">IT勉強会/コミュニティ運営 Advent Calendar 2016</a> (@ADVENTAR) 17 日目のエントリです。</p>

<p><strong>「勉強会/コミュニティ運営」</strong>!!</p>

<p>すごいお題なのですが、残念ながら私はあまり「運営」という行為をやってる気がしていないので、運営に役立つ話とか、他の何かの運営に参考になるお話はできそうにありません。</p>

<p>定期的に行っている「<a href="https://sites.google.com/site/containerstudy/">コンテナ型仮想化の情報交換会</a>」という勉強会に関するおっさんの回顧録です。たぶん、何度も勉強会の案内でお話してますし、一部は<a href="https://sites.google.com/site/containerstudy/">勉強会ページ</a>にも書いてあります。</p>

<p>まあ一種のポエムですので、ヒマな方はどうぞ。</p>

<p>ヒマでない方は<a href="https://sites.google.com/site/containerstudy/">勉強会ページ</a>で過去の勉強会の動画を公開していますので興味のあるやつをご覧になったりして、もしご興味があれば<a href="https://ct-study.connpass.com/">connpassの勉強会グループ</a>がありますので、メンバーになっていただいて、開催の際にはぜひご参加をご検討ください。</p>

<p>よろしくです〜。</p>

<h2>きっかけ〜第1回</h2>

<p>きっかけは全くコンテナという言葉が一般的でないころ、コンテナとはほとんど関係ない場所でした。</p>

<p>2012年の<a href="http://asterisk.gr.jp/">日本Asteriskユーザ会(J*UG)</a>というOSSの電話交換機ソフトウェアのユーザ会の忘年会で <a href="https://twitter.com/masahide7">@masahide7</a> さんと、コンテナの勉強会って日本でないよね、来年はぜひやろう！という会話を酔っ払いながらやったのがはじめです。</p>

<p>まだ時代は Docker 前夜ですね。この頃だと、IT業界で「コンテナ」というと IIJ さんとかがコンテナ型データセンターとかで色々発表されていたころなので、そちらをイメージされる方が多かったと思います。これは第2回のあたりまでそんな感じでした。</p>

<p>いちおう、この時期よりだいぶ前 (2011年夏ごろ) には、twitter でのつぶやきが元で <a href="https://twitter.com/mkouhei">@mkouhei さん</a>に <a href="https://groups.google.com/forum/#!forum/lxc-jp">lxc-jp</a> という Google Group は作っていただいていました。</p>

<p>私は、この頃までは「どっかに日本語で情報交換出来る場はないかな」とか「どっかで勉強会やってないのかな」という他力本願な考えがメインでした。自分で勉強会やるのって大変そうだしどっかでやらないかなあと思っていました。</p>

<blockquote class="twitter-tweet" data-lang="en-gb"><p lang="ja" dir="ltr"><a href="https://twitter.com/mkouhei">@mkouhei</a> 日本語でlxcとかコンテナの話や質問が出来る場が欲しいなあ。どっかありませんかね？作るしかない？(^^;)</p>&mdash; TenForward%25シクレペンミ (@ten_forward) <a href="https://twitter.com/ten_forward/status/86633606956597249">1 July 2011</a></blockquote>


<script async src="http://tenforward.github.io//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>前述の J*UG 忘年会の後、呑みの場だけの話ではもったいないし、探してもやっぱりコンテナの勉強会ってないし、じゃあこの勉強会全盛の世の中、募集サイトも <a href="http://atnd.org/">atnd</a> やら色々ツールがあるので、いっちょう始めてみるか! ってことで、会場も<a href="http://www.qloog.com/ja/">クルーグさん</a>のキレイな会議室を快く提供いただけたので、早速Zusaarに勉強会ページを作成したのでした。</p>

<p>コンテナなんてマイナーな技術だし、少人数だったらセミナー形式でなく、机囲んで色々議論しようかとか考えたので、勉強会名は「コンテナ情報交換会」という「情報交換」という名前を入れたのでした。少人数とはいえ机を囲むくらいは集まるだろうという目論見でした。</p>

<p>ところが! 募集ページを公開したもの、ずっと参加者が<strong>2名</strong>!! つまり主催者 2 名　(私と @masahide7 さん)!! だけの状態でした。</p>

<p>うわ〜、やばいな。これは主催者ふたりでサシ飲みでコンテナについて語って勉強会か! と本気で考えておりました (^_^;)。</p>

<p>その後、クルーグさんのエンジニアの方、あと奇跡的に参加頂いた一般応募の方 1 名、東京からリモートで参加いただくということで <a href="https://twitter.com/peo3">@peo3 さん</a>が参加いただけるということで、なんとか普通の勉強会として開催できたのでした。</p>

<ul>
<li><a href="http://www.zusaar.com/event/686003">第1回 コンテナ情報交換会＠関西</a></li>
</ul>


<p>プログラムも適当で、私はまだ発表とか慣れてなかったので、コンテナ関連技術について 120 分くらい話してたような気がします。</p>

<p>参加者数が盛り上がらなかったのに反して、内容はこの時期にしてはすごい内容でした。私のはそれまでの機能の推移をまとめただけの発表でしたので置いといて…、</p>

<p>@masahide7 さんはこの時期日本ではほとんど話題にはなっていなかった <strong>Docker のお話</strong>と、最近結構実用になってきてる感じのあるカーネルのライブパッチングのお話、@peo3 さんはなんと <strong>CRIU のお話</strong> でした!!</p>

<ul>
<li><a href="http://d.hatena.ne.jp/defiant/20130601/1370101802">第1回コンテナ情報交換会で『Linuxコンテナ最新情報』というお題で発表してきました</a></li>
</ul>


<p>おふたりの情報収集能力の高さと、この時点で収集だけでなく内部まで踏み込んで調べている先進性には驚いたものです。</p>

<p>ちなみに、この時の参加者であった <a href="https://twitter.com/tsubasaxZZZ">@tsubasaxZZZ さん</a>には、その後勉強会で二度ご登壇いただいています。この時の出会いがないとその後開催してない勉強会があるかも!?</p>

<h2>第1回の後</h2>

<p>Docker が OSS になったの 2013 年 3 月で、たぶん日本の勉強会で 1, 2 番を争う速さで 2013 年 6 月 9 日に Docker が紹介されましたが、なんせ 7 名参加でしたし、特に大きな話題になることはありませんでした。</p>

<p>日本でまず最初にそれなりに Docker が話題になったのは、</p>

<ul>
<li><a href="http://d.hatena.ne.jp/naoya/20130620">Docker (土曜日に podcast します)</a> (naoyaのはてなダイアリー)</li>
</ul>


<p>のエントリとそこに書かれてる podcast からじゃないですかね。惜しい! ほんの半月ほど勉強会が早かった :p</p>

<p>このあたりで少し Docker が盛り上がりはしましたが、まだ大ブレークというわけでもなく、コンテナが一般的になるわけでもありませんでした。</p>

<p>コンテナ勉強会はというと、第1回が終わった後、数人の方から「これ東京でやったら絶対人くるよ」と言われたのですが、第1回開催後の私にはあまり信じられませんでした。それでも「いや絶対くるって」みたいなお話もいただいていたので、本当かなあ、と思いつつ、じゃあちょっと動いてみることにしました。</p>

<h2>第2回</h2>

<p>とはいえ、東京に人脈があるわけでもなく、会場のアテも全くない状態なので、ひとまず人が集まりそうなのかどうかを調査することにしました。</p>

<p>（今となっては画面キャプチャでも残しておけば！と思ってるんですが）、atnd に <strong>「もしコンテナの勉強会を開催したら参加してもいいよという人は応募してね」</strong> という<strong>ふざけた仮想イベント</strong>を立ち上げたのでした。</p>

<p>イベント募集サイトをこういう風に使ったことある人なかなかいないのでは? :-D</p>

<p>20〜30人くらい参加したいという人が集まったら正式イベントにしようかなという考えでした。人が集まりそうな感触が得られたら開こうということですね。</p>

<p>すると、やはり東京。徐々に応募者が増えまして、20 名を超えだしました。その中に、当時は株式会社paperboy&amp;co.にいらっしゃった、当時から広くお名前が知られていた <a href="https://twitter.com/gosukenator">mizzy さん</a>や <a href="https://twitter.com/hiboma">@hiboma さん</a>がご応募と同時に「うちの会社の会議室を提供しますよ」とおっしゃっていただいたので、「おおこれは会場の手当もついた！開催しよう」と決心をしたのでした。</p>

<ul>
<li><a href="https://atnd.org/events/40915">第2回 コンテナ型仮想化の情報交換会＠東京 (コンテナ型VMや関連するカーネル等の技術が話題の勉強会)</a></li>
</ul>


<p>（↑の募集サイト、仮想イベントの頃の名残も少し残ってますね。コメント欄とかも）</p>

<p>これが当時の勉強会サイトで、参加者欄の番号が若い方をご覧いただくとわかりますが、応募と同時に会場だけでなく、スピーカーも決定しているのがわかります。さらには <a href="https://twitter.com/syuu1228">@syuu1228 さん</a>から運営のお手伝いのお申し出を頂いています。結局この時は @syuu1228 さんに中継、録画と懇親会の幹事をやっていただけることになりました。</p>

<p>また、この時期は依然として「コンテナ」といえば「データセンターかと思った」という声のほうが主流だったので、@syuu1228 さんのアドバイスに従って「仮想化技術であること」「カーネルやVMなどの技術関連の勉強会であること」がはっきりわかるようにしたので、前述のような長い名前の勉強会名になったのでした。結局この時の名前がベースとなって、今でも「コンテナ型仮想化の情報交換会」という名前になっています。</p>

<p>あとはダメ押しで、サブタイトルに「コンテナ型データセンターでも貨物輸送のコンテナの勉強会でもありません :)」と書いてわかりやすくしました。これはコンテナが一般的になった今でもそのまま使ってます。</p>

<p>さて、先に書いたように発表者も大体決まった感じでしたが、この時点では会場は 30 名程度で、参加者もそれにすこし足りない程度だったので、この時点で発表を決めていた人は、それくらいの少人数相手に、当時はマニアックなネタを気軽に話そうかという感じだった気がします。</p>

<p>ところがこの頃から徐々に勉強会が知られたのでしょうか (今考えると信じられないような豪華メンバーなので当然なのかもしれないのですがw)、登録人数が徐々に増加していき、30 名の会場には収まらない応募になっていました。そのあたりで、今でも東京で開催するたびにお世話になっている <a href="https://twitter.com/BSDHacker">@BsdHacker さん</a>より <a href="http://www.iij.ad.jp/">IIJ さん</a>の会場のご提供をお申し出いただき、定員の問題は解決したのでした。この時以来、東京での開催の際には IIJ さんの会議室をお借りしています。いつもありがとうございます。</p>

<p>はっきり覚えてないのですが、秋になってから(?)は毎日のように参加登録が続き、毎日何人増えたかなーと楽しみに数字の変化を視てた気がします。最終的には申込者数は 200 名近くまでいきました。当初 30 名程度のつもりで発表ネタを準備していた登壇者大慌てみたいな感じにはなってました (^_^;)</p>

<p>この時は本当に興奮しましたね。まさかこんな大規模な勉強会になるとは思ってなかったということもありますが、ある意味 IT 業界の有名人で雲の上の人という感じの存在だった人に参加していただいて、直接お会いできただけでなく、私のブログを良く見てました、とか言ってもらえたりと、目立たないネタでもアウトプットしておくものだなあと思ったものです。</p>

<p>しかも、皆さんの発表内容も Linux から FreeBSD、Linux でも OpenVZ、LXC、Docker、扱う内容も紹介から技術的な仕組みから活用事例・応用まで幅広く、とても勉強になるものでした。</p>

<p>この第2回は、その後の開催とくらべて結構参加者層が違っていた感じがしていまして、そういう意味でも貴重な体験でした。たぶん @syuu1228 さん人脈(?)経由で勉強会を知ったカーネル/VM方面の方々、mizzy さん人脈(?)経由のインフラを扱ってるけど比較的 Web アプリ開発に近い方々がいらっしゃていたのではないかなと思っています。ここに挙げた以外にも参加者を見るとかなり著名な方の名前を見つけることができます。まさかこんな方々が参加するような勉強会になるなんて、まあ勉強会の中身とは全く関係ないミーハーな感覚なんですが、それでもミーハーな私には興奮するできごとでしたね。</p>

<p>それとともに、その後の勉強会につながる出会いもたくさんありました。この時の興奮は私のブログエントリでも感じられます。</p>

<ul>
<li><a href="http://d.hatena.ne.jp/defiant/20131007/1381147399">『第2回 コンテナ型仮想化の情報交換会＠東京』を開催し『Linux コンテナ入門』というお題で発表してきました</a></li>
</ul>


<p>（考えてみると私の持ちネタ、この頃から基本変わってなくて進歩がないな…）</p>

<p>勉強会の翌日（私がまだ大阪に帰ってないとき）には動画が YouTube にアップされて、<a href="http://www.kernelvm.org/kanren-ibento/di2hui-kontena-xing-jia-xiang-huano-qing-bao-jiao-huan-hui-dong-jing">ページが作成され公開されている</a>とか、@syuu1228 さんの仕事の速さにも驚き感謝しました。この時から流れで、ずっと勉強会の発表の様子を公開しています。</p>

<h2>第2回の後</h2>

<p>以上のような盛況ではありましたが、まだ一般的に「コンテナ」がブレークする状況ではなかった気がします。このツイートは何度も紹介してるのですがw (@m_asama さんすみません)</p>

<blockquote class="twitter-tweet" data-lang="en-gb"><p lang="ja" dir="ltr">つかコンテナ型でこんだけ集まるのおかしくね？？</p>&mdash; Masakazu Asama (@m_asama) <a href="https://twitter.com/m_asama/status/386320379255324672">5 October 2013</a></blockquote>


<script async src="http://tenforward.github.io//platform.twitter.com/widgets.js" charset="utf-8"></script>


<p>コンテナや Docker が一気にブレークしたのは、なんか長い名前で舌を噛みそうなこのあたりではなかったでしょうかね。</p>

<ul>
<li><a href="https://atnd.org/events/47786">Immutable Infrastructure Conference #1</a></li>
</ul>


<h2>その後</h2>

<p>この後、大阪では私の所属する会社の会議室で、東京は IIJ さんの会議室をお借りする形で開催しています。一度だけ東京では IIJ さんの本社移転の影響で、会議室がお借りできないときがあありました。</p>

<p>この時は相変わらず人脈ないマンだったので、どうしようかなと迷った挙句に深夜に「誰か貸してくれね？」とつぶやいたら、ニフティの方が（しかも複数！）同時にお返事くださいまして、この時はニフティ株式会社のセミナールームをお借りして開催しました。</p>

<p>つぶやいてみるものです。ありがとうございました。</p>

<p>それと、lxc-jp 創設者の @mkouhei さんに一度ぜひ参加いただかないと！というきっかけで、東京で平日夜開催したことがありました。このときはプログラムの調整では結局 @mkouhei さんにおんぶにだっこでした。また機会があれば平日夜東京ってのもやってみてもいいかなと思っています。</p>

<p>大阪も一度平日開催をやってライバル会社の社長さん登壇ってのやりましたね。ありがとうございました。</p>

<p>この後は、第9回では、なんとGMOペパボ株式会社の福岡支社を会場に開催という、初の大阪東京以外の開催をすることができました!! この福岡の開催の際は一度日程延期にしたり、色々苦労がありました。福岡のペパボの皆さんありがとうございました。</p>

<p>このペースで書いてると今日中にエントリできないので、あとは勉強会ページの各回のページとか動画とかをご覧いただければ。</p>

<h2>スピーカー探し</h2>

<p>基本、今でもメインスピーカーは私がお話を聞きたい人に直接お願いするようにしています。<strong>私が一番満足できる勉強会を目指してますので</strong> :-p</p>

<p>全スピーカー公募ってのは<a href="https://ct-study.connpass.com/event/15121/">大阪で一度失敗した</a>ので、当面はやる予定はありません。一部のスピーカーの募集は今後ありますし、LT は毎回一般公募です。</p>

<p>勉強会自体もそれなりに知られるようになって、「あの人の話聞きたいな」とか「面白そうなことつぶやいてる人いる」とかいると、ツイッターなんかで「こういう者ですが、次回お話いただけませんか？」といきなり直撃依頼しても、受けていただけるようになりましたね。今でも会ったことない人や、今でも雲の上の人なんかに直接初めて DM したり、mention 送ったりするのかなり勇気いるんですけど。直接イベントでお願いするなんてこともやりました（ありがとうございます）。</p>

<p>というわけで、今後いきなりお願いされる人、いきなりで失礼ですがよろしくお願いいたします。</p>

<h2>感謝</h2>

<p>勉強会やコミュニティのような場合、スタッフが複数いて運営されている場合が多いと思いますが、「コンテナ型仮想化の情報交換会」は、以上のような感じで勉強会の企画（開催時期決定、スピーカー依頼、調整）は私だけで行っています。なので組織として運営されている勉強会でもなく、コミュニティ主催の勉強会でもなく、私が開きたいときに、会場をお願いする方に色々お願いをしながら開催しているという感じです。</p>

<p>大阪で開催する際は自社の会議室です。同僚に手伝ってもらって自分含めて準備をしたりしています。お手伝い頂いた方々、ありがとうございます。</p>

<p>遠隔地（東京、福岡）で開催する際は、会場をお借りする会社の方におんぶにだっこで、実は私はスピーカーと日程が決まった後は何もしていません。行って開いて飲んで帰ってくるだけです。その分、会場をお願いした方々、懇親会の幹事をやっていただいた方々には非常にご苦労をおかけしており、ひたすら感謝するだけです。</p>

<p>先日の第10回も「懇親会幹事を募集します」と呼びかけたらかなりの人数の方に応募頂き、お願いして幹事をやっていただきました。ありがとうございました。</p>

<p>本当に自主的にお申し出いただいて、私がお願いする前ですら色々動いてくださる方がいてこそ、このコンテナ勉強会が開けています。ありがとうございます。（特に何度もお願いしている東京の @BSDHacker さん）</p>

<p>それと、やはり東京だと毎回 100 名を超える方に、大阪・福岡でも 30 名を超える方に参加頂いているからこそ、勉強会も盛り上がって続けられている面はあると思います。ありがとうございます。今後も興味のある話題があるかぎりは続けていきたいと思っていますのでよろしくお願いいたします。</p>

<p>そして、毎回依頼を聞いていただいて期待以上の発表をしていただいている登壇者の皆様、ありがとうございます。これこそ勉強会の要です。これがずっと面白いので、期待以上の参加者がずっと集まっているのだと思います。</p>

<p>（お世話になった方の紹介が一部しかできていませんがスミマセン）</p>

<h2>開催してよかったこと</h2>

<p>私はコミュ障なので、参加者として勉強会に参加すると静かに参加して静かに帰るタイプです。まあなんとなく懇親会は参加しますが、積極的に話すこともない。なので世界も広がらない。</p>

<p>でも勉強会の主催となると、懇親会では全員とお話する理由がありますし、皆さんにアウェー感与えないために全員と無理にでも話をするようにはしてます（完全にはできてないのですが）。（勉強会中もそうできれば良いのですがなかなかできません…）</p>

<p>それに皆さんに顔と名前を覚えてもらえるので、参加者の皆さんから声をかけていただけるので、おかげでお知り合いも増えて世界が広がった気がします。</p>

<p>自分からどんどん知らない人に話しかけたりできないし、勉強会出ても知り合いが増えないという方は、スタッフとして勉強会に携わるか、登壇者として話してみると良いと思いますね。</p>

<p>これも勉強会主催してよかったことのひとつですね。</p>

<h2>今後</h2>

<p>大阪、東京メインで開催していますが、それ以外でも会場を提供いただける場所と、お話いただける方がいらっしゃれば、私のいつもの持ちネタ「Linuxコンテナ入門」と共にお伺いできます、というかぜひやりたいです!! お声がけお待ちしております。北海道とか沖縄でも行きますよ！（行きたいだけ）</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Firefoxでssl_error_bad_mac_alert]]></title>
    <link href="http://tenforward.github.io/blog/2015/04/13/ssl-error-bad-mac-alert/"/>
    <updated>2015-04-13T16:32:59+09:00</updated>
    <id>http://tenforward.github.io/blog/2015/04/13/ssl-error-bad-mac-alert</id>
    <content type="html"><![CDATA[<p>とあるサイトに firefox 37.0.1 (Linux版, Mac版で確認) で https アクセスすると</p>

<p><img src="http://tenforward.github.io/images/ssl_error_bad_mac_alert/ssl_error_bad_mac_alert_1.png"></p>

<p>というエラーが出ます。</p>

<p><img src="http://tenforward.github.io/images/ssl_error_bad_mac_alert/ssl_error_bad_mac_alert_2.png">
<img src="http://tenforward.github.io/images/ssl_error_bad_mac_alert/ssl_error_bad_mac_alert_3.png"></p>

<p>これだけだと中間証明書がサーバ側に置かれてないのでツリーをたどれないのかな？と思いますが、ここでこのエラーを無視してそのままアクセスすると</p>

<p><img src="http://tenforward.github.io/images/ssl_error_bad_mac_alert/ssl_error_bad_mac_alert_4.png"></p>

<p>こんなエラーに。これは初めて見るなあ。MAC のエラー&hellip;</p>

<p>とりあえずサイトに報告しておきます。以下のブラウザでは <strong>問題ありません</strong> 。</p>

<ul>
<li>Windows 版 IE 11, Chrome 41.0.2272.118</li>
<li>Mac 版 Chrome 41.0.2272.118, Safari 8.0.4</li>
<li>Linux 版 Chrome 41.0.2272.76</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Firefox と Fcitx の組み合わせで Facebook にコメントできない]]></title>
    <link href="http://tenforward.github.io/blog/2015/03/26/firefox-fcitx/"/>
    <updated>2015-03-26T15:21:16+09:00</updated>
    <id>http://tenforward.github.io/blog/2015/03/26/firefox-fcitx</id>
    <content type="html"><![CDATA[<p>Plamo Linux ではブラウザは Firefox で、日本語入力には fcitx + mozc を使っている (fcitx, mozc は Plamo パッケージでなく自前ビルドのパッケージ)。</p>

<p>いつの頃からか (firefox 35 辺り?) Facebook のコメント (普通のポストは可能) ができなくなっている (ibus も。uim は行けた気がする)。</p>

<p>調べてみると、</p>

<ul>
<li>Facebook のコメント</li>
<li>Google Docs</li>
</ul>


<p>辺りで起こっている模様。</p>

<ul>
<li><a href="https://bbs.archlinux.org/viewtopic.php?id=194083">[Solved] Firefox Facebook cannot comment with fcitx</a> (archlinux bbs)</li>
<li><a href="https://lists.ubuntu.com/archives/ubuntu-jp/2015-January/005090.html">[ubuntu-jp:5901] facebookで他人のコメントに日本語で打ち込むとき最初の数回入力が反映されないubuntu 14.04 fcitx mozc firefox</a> (ubuntu-jp ML)</li>
</ul>


<p>fcitx の preedit モードをオフにすれば良いようだがなんだかみっともない ^^;</p>

<ul>
<li><a href="https://fcitx-im.org/wiki/FAQ#Problem_in_Firefox_and_Google_Docs">Problem in Firefox and Google Docs</a> (FAQ &ndash; Fcitx)</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[StartSSLの発行直後の証明書とOCSP]]></title>
    <link href="http://tenforward.github.io/blog/2015/03/20/startssl-ocsp/"/>
    <updated>2015-03-20T15:36:35+09:00</updated>
    <id>http://tenforward.github.io/blog/2015/03/20/startssl-ocsp</id>
    <content type="html"><![CDATA[<p><a href="https://www.startssl.com/">StartSSL</a> でサーバ証明書を発行して Web サーバに設定しました。確認のために Firefox でアクセスすると、</p>

<p><img src="http://tenforward.github.io/images/startssl/ocsp_err1.png"></p>

<p>&ldquo;sec_error_ocsp_unknown_cert&rdquo; というエラーです。</p>

<p>Firefox はデフォルトでは OCSP レスポンダに問い合わせて証明書の有効性を確認するようです。</p>

<p><img src="http://tenforward.github.io/images/startssl/firefox_ocsp.png"></p>

<p>ぐぐってみると似たような話題があります。</p>

<ul>
<li><a href="https://forum.startcom.org/viewtopic.php?f=15&amp;t=2654">Certificate OCSP Validation Failiure in Firefox</a> (Official StartCom Public User Forum)</li>
</ul>


<p>StartSSL の OCSP レスポンダに新たに発行した証明書の情報が反映されるのに時間がかかるということでしょうかね。試してみました。フォーラムでは 6 時間くらいしたら反映された、という話もあるのでしばらくかかるのかも。</p>

<h2>準備</h2>

<p>StartSSL は中間証明書を使いますのでその準備を。StartSSL の CA 証明書と中間証明書を取得し、openssl の c_hash ユーティリティを使ってハッシュ値のリンクを作っておきます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls -l start.com/
</span><span class='line'>合計 8,192
</span><span class='line'>lrwxrwxrwx 1 karma users    24  3月 19日  17:35 38d751eb.0 -&gt; sub.class1.server.ca.pem
</span><span class='line'>lrwxrwxrwx 1 karma users     6  3月 19日  17:35 ae8153b9.0 -&gt; ca.pem
</span><span class='line'>-rw-r--r-- 1 karma users 2,760  5月  7日 2008年 ca.pem
</span><span class='line'>-rw-r--r-- 1 karma users 2,090  2月  5日  06:10 sub.class1.server.ca.pem</span></code></pre></td></tr></table></div></figure>


<h2>正常な場合</h2>

<p>まずは StartSSL で発行した証明書で Firefox からもアクセスできている証明書で試してみましょう。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ openssl ocsp \
</span><span class='line'>&gt; -issuer start.com/sub.class1.server.ca.pem \
</span><span class='line'>&gt; -cert guinan.ten-forward.ws.crt \
</span><span class='line'>&gt; -url http://ocsp.startssl.com/sub/class1/server/ca \
</span><span class='line'>&gt; -header Host ocsp.startssl.com \
</span><span class='line'>&gt; -CApath start.com/ 
</span><span class='line'>WARNING: no nonce in response
</span><span class='line'>Response verify OK
</span><span class='line'>guinan.ten-forward.ws.crt: good
</span><span class='line'>  This Update: Mar 19 06:01:44 2015 GMT
</span><span class='line'>  Next Update: Mar 21 06:01:44 2015 GMT</span></code></pre></td></tr></table></div></figure>


<ul>
<li>issuer: Issuerの証明書</li>
<li>cert: チェック対象の証明書</li>
<li>url: OCSP レスポンダの URL</li>
<li>header: OCSP レスポンダがバーチャルホストの場合に Host ヘッダを送る必要があるのでそれを記述</li>
<li>CApath: 事前に準備したディレクトリ</li>
</ul>


<p><strong>&ldquo;good&rdquo; と出ていますね</strong>。</p>

<h2>発行直後のもの</h2>

<p>発行直後で Firefox でアクセスするとエラーになる証明書で上記と同様にやってみます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ openssl ocsp \
</span><span class='line'>&gt; -issuer start.com/sub.class1.server.ca.pem \
</span><span class='line'>&gt; -cert kilkenny.harp.gr.jp.crt \
</span><span class='line'>&gt; -url http://ocsp.startssl.com/sub/class1/server/ca \
</span><span class='line'>&gt; -header Host ocsp.startssl.com \
</span><span class='line'>&gt; -CApath start.com/ 
</span><span class='line'>WARNING: no nonce in response
</span><span class='line'>Response verify OK
</span><span class='line'>kilkenny.harp.gr.jp.crt: unknown
</span><span class='line'>  This Update: Mar 19 07:31:50 2015 GMT
</span><span class='line'>  Next Update: Mar 21 07:31:50 2015 GMT</span></code></pre></td></tr></table></div></figure>


<p>確かに &ldquo;unknown&rdquo; と返ってきています。これで&#8221;sec_error_ocsp_unknown_cert&#8221;となるのもわかります。</p>

<h2>少し時間が経った後</h2>

<p>上記と同じようにやってみると、</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ openssl ocsp \
</span><span class='line'>&gt; -issuer start.com/sub.class1.server.ca.pem \
</span><span class='line'>&gt; -cert kilkenny.harp.gr.jp.crt \
</span><span class='line'>&gt; -url http://ocsp.startssl.com/sub/class1/server/ca \
</span><span class='line'>&gt; -header Host ocsp.startssl.com \
</span><span class='line'>&gt; -CApath start.com/
</span><span class='line'>WARNING: no nonce in response
</span><span class='line'>Response verify OK
</span><span class='line'>kilkenny.harp.gr.jp.crt: good
</span><span class='line'>  This Update: Mar 20 06:37:15 2015 GMT
</span><span class='line'>  Next Update: Mar 22 06:37:15 2015 GMT</span></code></pre></td></tr></table></div></figure>


<p><strong>無事 good になりました</strong>。</p>

<h2>まとめ</h2>

<p>StartSSL でサーバ証明書を発行する場合は少し余裕を持って、発行されてから少し経った後に証明書のインストール・入れ替えをすると良いと思います。</p>

<h2>おまけ</h2>

<p>上記のコマンドで <code>-resp_text</code> とオプションを付けると、レスポンスの出力ができます。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ openssl ocsp (..略..) -resp_text
</span><span class='line'>OCSP Response Data:
</span><span class='line'>    OCSP Response Status: successful (0x0)
</span><span class='line'>    Response Type: Basic OCSP Response
</span><span class='line'>    Version: 1 (0x0)
</span><span class='line'>    Responder Id: C = IL, O = StartCom Ltd. (Start Commercial Limited), CN = StartCom Class 1 Server OCSP Signer
</span><span class='line'>    Produced At: Mar 20 06:37:15 2015 GMT
</span><span class='line'>    Responses:
</span><span class='line'>    Certificate ID:
</span><span class='line'>      Hash Algorithm: sha1
</span><span class='line'>      Issuer Name Hash: 6568874F40750F016A3475625E1F5C93E5A26D58
</span><span class='line'>      Issuer Key Hash: EB4234D098B0AB9FF41B6B08F7CC642EEF0E2C45
</span><span class='line'>      Serial Number: 0564461CA61DBC
</span><span class='line'>    Cert Status: good
</span><span class='line'>    This Update: Mar 20 06:37:15 2015 GMT
</span><span class='line'>    Next Update: Mar 22 06:37:15 2015 GMT
</span><span class='line'>  : (略)</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[StartSSLのクライアント証明書の認証がエラーになる]]></title>
    <link href="http://tenforward.github.io/blog/2015/03/19/startssl-problem/"/>
    <updated>2015-03-19T14:26:33+09:00</updated>
    <id>http://tenforward.github.io/blog/2015/03/19/startssl-problem</id>
    <content type="html"><![CDATA[<p><a href="https://www.startssl.com/">StartSSL</a>では、証明書の発行などの処理を行う場合はクライアント証明書による認証でログインして色々な処理を行いますが、<strong>有効な証明書をブラウザにインストールしているのに</strong>、なぜかエラーになっていたので少し調べてみました。</p>

<ul>
<li><a href="http://kijitora.sabatora.info/wordpress/archives/319">「StartComからクライアント証明書を調達する」</a> (SiTE Arinko)</li>
</ul>


<p>にあるのと同じエラーでした。</p>

<p><img src="http://tenforward.github.io/images/startssl/startcom1.png"></p>

<p>解決方法は実は以下に書いてあるので、それを見れば終わりです。</p>

<ul>
<li><a href="https://forum.startcom.org/viewtopic.php?f=15&amp;t=15794&amp;p=21375">HOWTO: Login issues</a> (Official StartCom Public User Forum)</li>
</ul>


<h2>Firefox の場合</h2>

<p>一応、firefox の場合を書いておきます。</p>

<ol>
<li>まずは証明書マネージャを開きます。<br/><img src="http://tenforward.github.io/images/startssl/startcom4.png"></li>
<li>認証局の証明書でStartComのモノのうち以下の画像のようなモノを探します。証明書のCNが&#8221;StartCom Certification Authority&#8221;で、発行者のCNが&#8221;StartCom Certification Authority G2&#8221;となっているものです。<br/><img src="http://tenforward.github.io/images/startssl/startcom2.png"></li>
<li>これを消去します。</li>
</ol>


<p>終わりです。ただし、この認証局証明書がない場合もあるようです。新しくFirefoxのProfileを作ってみるとありませんでした。ずっとProfileを使い続けているとあるものなのかも知れません。以下のように前述の画像と比べるとStartComの証明書の数が全然違います。問題となる証明書がない場合は正常に認証されるのでしょう。</p>

<p><img src="http://tenforward.github.io/images/startssl/startcom3.png"></p>

<h2>Chrome (Linux) の場合</h2>

<p>Linux 版 Chrome でも証明書マネージャから同じ証明書を探して消去すれば OK でした。</p>

<p><img src="http://tenforward.github.io/images/startssl/startcom7.png"></p>

<h2>Windows (IE/Chrome) の場合</h2>

<p>Windows でも同じエラーになりました。</p>

<p><img src="http://tenforward.github.io/images/startssl/startcom5.png"><br/>(IE)</p>

<p><img src="http://tenforward.github.io/images/startssl/startcom6.png"><br/>(Chrome)</p>

<p>Windows の証明書ストアを開いて見ましたが、先の HOWTO のように「中間証明機関」のところにも「信頼されたルート証明機関」のところにも目的の証明書を見つけられませんでした。</p>

<p>見つかれば消去すれば良いようですが…</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Raspberry Pi を無線 LAN アクセスポイントに]]></title>
    <link href="http://tenforward.github.io/blog/2013/12/24/hostapd/"/>
    <updated>2013-12-24T00:13:10+09:00</updated>
    <id>http://tenforward.github.io/blog/2013/12/24/hostapd</id>
    <content type="html"><![CDATA[<p>自宅には Buffalo の無線 LAN ルーターがあって，それをアクセスポイント (以降 AP) として使っているのですが，とある理由でもう 1 つ別の AP を置こうということになり，丁度余っていた Raspberry Pi を AP に仕立てる事にしました．</p>

<p>同じ内容を扱うブログエントリは検索すると多数出てきますので，これは単なる個人用メモ代わりに近いです．検索で出てくる多くの内容は無線 LAN 側にアドレスを割り当てて iptables で NAT するパターンが多いですが，自宅だと既に NAT がかかっている事が多く，さらに NAT する意味がウチで使う限りはあまり感じられないので，単なるブリッジとして設定してみました．</p>

<h3>USB 無線 LAN 子機</h3>

<p>選択した無線 LAN 子機は Buffalo の <a href="http://www.amazon.co.jp/gp/product/B005DU4XPU/">WLI-UC-GNM2T</a> というものでした．これだと AP として使うソフトの hostapd が対応している模様なので (WLI-UC-GNM2 というパッケージだけ違うモデルもあります．WLI-UC-GNM は似てるけど使ってるチップが違う模様)</p>

<h3>Raspberry Pi 側の準備</h3>

<ol>
<li>普通に Raspbian をインストールします</li>
<li>追加でパッケージをインストールします <pre>$ sudo apt-get install bridge-utils hostapd</pre></li>
<li>/etc/network/interfaces の設定 <pre>
auto lo
iface lo inet loopback<br/>
iface eth0 inet manual<br/>
allow-hotplug wlan0
iface wlan0 inet manual<br/>
auto br0
iface br0 inet dhcp
bridge_ports eth0</pre>

<ul>
<li>ブリッジ br0 を作成し，DHCP でアドレスを取得します．eth0, wlan0 を manual にして，eth0 を br0 にアタッチします．wlan0 は後ほど hostapd で br0 にアタッチする設定をします</li>
</ul>
</li>
</ol>


<h3>hostapd の設定</h3>

<p>パッケージに含まれない設定ファイルを /etc/hostapd/hostapd.conf に作成します．あまり意味分かってません．サンプルファイルを元に設定しました．</p>

<ul>
<li><code>bridge=br0</code> で br0 にアタッチしています</li>
<li><code>wmm_*</code> という設定は検索して出てくる設定例にはないことが多いですが，ないと問題が起きるという事が書いてある所もあったのでサンプルのものそのままで設定しました

<ul>
<li>WPA2 の所はこんな感じで良いのかなあと．</li>
</ul>
</li>
</ul>


<pre>
# interface
interface=wlan0
bridge=br0

# driver
driver=nl80211

# logger
logger_syslog=-1
logger_syslog_level=2
logger_stdout=-1
logger_stdout_level=2

# files
dump_file=/tmp/hostapd.dump
ctrl_interface=/var/run/hostapd

ctrl_interface_group=0


##### IEEE 802.11 related configuration #######################################

ssid=黄巾のLAN
country_code=JP
ieee80211d=1
hw_mode=g
channel=1
beacon_int=100
dtim_period=2
max_num_sta=255
rts_threshold=2347
fragm_threshold=2346

macaddr_acl=0
#accept_mac_file=/etc/hostapd.accept
#deny_mac_file=/etc/hostapd.deny

auth_algs=3
ignore_broadcast_ssid=0

wmm_enabled=1
# Low priority / AC_BK = background
wmm_ac_bk_cwmin=4
wmm_ac_bk_cwmax=10
wmm_ac_bk_aifs=7
wmm_ac_bk_txop_limit=0
wmm_ac_bk_acm=0
# Normal priority / AC_BE = best effort
wmm_ac_be_aifs=3
wmm_ac_be_cwmin=4
wmm_ac_be_cwmax=10
wmm_ac_be_txop_limit=0
wmm_ac_be_acm=0
# High priority / AC_VI = video
wmm_ac_vi_aifs=2
wmm_ac_vi_cwmin=3
wmm_ac_vi_cwmax=4
wmm_ac_vi_txop_limit=94
wmm_ac_vi_acm=0
# Highest priority / AC_VO = voice
wmm_ac_vo_aifs=2
wmm_ac_vo_cwmin=2
wmm_ac_vo_cwmax=3
wmm_ac_vo_txop_limit=47
wmm_ac_vo_acm=0

wpa=2
wpa_passphrase=hogehoge
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
</pre>


<p>サービスを起動させると</p>

<pre>
root@raspberrypi:/etc/cron.d# brctl show
bridge name bridge id       STP enabled interfaces
br0     8000.b0c74546d440   no      eth0
                            wlan0
</pre>


<p>こんな感じで br0 にアタッチされてます．Android 4.1, iOS 7, Mac OS 10.9 で接続できました．</p>
]]></content>
  </entry>
  
</feed>
